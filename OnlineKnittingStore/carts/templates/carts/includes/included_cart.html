{% load static %}
{% load carts_tags %}

{% user_carts request as carts %}

<div class="card mb-4 shadow-sm">
    {% for cart in carts %}
        <div class="card-header bg-white">
            <h5 class="mb-0 fw-semibold">{{ cart.product.name }}</h5>
        </div>

        <div class="card-body">
            <div class="row align-items-center text-center gy-3">

                <!-- Количество -->
                <div class="col-12 col-md-3">
                    <div class="input-group input-group-sm justify-content-center">
                        <button type="button"
                                class="btn btn-outline-secondary decrement"
                                data-cart-id="{{ cart.id }}"
                                data-cart-change-url="{% url 'cart:cart_change' %}">
                            {% csrf_token %}
                            −
                        </button>

                        <input type="text"
                               class="form-control text-center number"
                               value="{{ cart.quantity }}"
                               readonly
                               style="max-width: 60px;">

                        <button type="button"
                                class="btn btn-outline-secondary increment"
                                data-cart-id="{{ cart.id }}"
                                data-cart-change-url="{% url 'cart:cart_change' %}">
                            {% csrf_token %}
                            +
                        </button>
                    </div>
                </div>

                <!-- Цена за единицу -->
                <div class="col-6 col-md-3">
                    <span class="text-muted">Цена</span>
                    <div class="fw-medium">{{ cart.product.sell_price }} ₽ </div>
                </div>

                <!-- Итого -->
                <div class="col-6 col-md-3">
                    <span class="text-muted">Сумма</span>
                    <div class="fw-bold fs-5">{{ cart.products_price }} ₽</div>
                </div>

                <!-- Удаление -->
                <div class="col-12 col-md-3">
                    <a href="{% url 'cart:cart_remove' %}"
                       class="btn btn-outline-danger btn-sm remove-from-cart d-flex align-items-center justify-content-center"
                       data-cart-id="{{ cart.id }}">
                        {% csrf_token %}
                        <img src="{% static 'deps/icons/trash3-fill.svg' %}"
                             alt="Удалить"
                             width="16"
                             height="16"
                             class="me-3">
                        Удалить
                    </a>
                </div>

            </div>
        </div>
    {% endfor %}
</div>

<!-- ИТОГО -->
<div class="card shadow-sm">
    <div class="card-body d-flex justify-content-between align-items-center">
        <div class="text-muted">
            Итого <strong>{{ carts.total_quantity }}</strong> товар(а)
        </div>
        <div class="fs-4 fw-bold">
            {{ carts.total_price }} ₽
        </div>
    </div>
</div>